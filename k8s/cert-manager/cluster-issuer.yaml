# ClusterIssuer for Let's Encrypt
# Supports both staging and production environments

---
# Staging Issuer (for testing - higher rate limits, fake certificates)
apiVersion: cert-manager.io/v1
kind: ClusterIssuer
metadata:
  name: letsencrypt-staging
  labels:
    app.kubernetes.io/name: cert-manager
    app.kubernetes.io/component: cluster-issuer
spec:
  acme:
    # Let's Encrypt staging server
    server: https://acme-staging-v02.api.letsencrypt.org/directory
    email: admin@son.duckdns.org
    privateKeySecretRef:
      name: letsencrypt-staging-key
    solvers:
      # HTTP-01 challenge solver (works with ingress)
      - http01:
          ingress:
            class: nginx
            serviceType: ClusterIP

---
# Production Issuer (real certificates, lower rate limits)
apiVersion: cert-manager.io/v1
kind: ClusterIssuer
metadata:
  name: letsencrypt-prod
  labels:
    app.kubernetes.io/name: cert-manager
    app.kubernetes.io/component: cluster-issuer
spec:
  acme:
    # Let's Encrypt production server
    server: https://acme-v02.api.letsencrypt.org/directory
    email: admin@son.duckdns.org
    privateKeySecretRef:
      name: letsencrypt-prod-key
    solvers:
      # HTTP-01 challenge solver
      - http01:
          ingress:
            class: nginx
            serviceType: ClusterIP

---
# Self-signed issuer for internal services
apiVersion: cert-manager.io/v1
kind: ClusterIssuer
metadata:
  name: selfsigned-issuer
  labels:
    app.kubernetes.io/name: cert-manager
    app.kubernetes.io/component: cluster-issuer
spec:
  selfSigned: {}

---
# CA Issuer for internal PKI
apiVersion: cert-manager.io/v1
kind: ClusterIssuer
metadata:
  name: internal-ca-issuer
  labels:
    app.kubernetes.io/name: cert-manager
    app.kubernetes.io/component: cluster-issuer
spec:
  ca:
    secretName: internal-ca-key-pair
